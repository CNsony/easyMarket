{"version":3,"sources":["components/imgLazyLoad/index.js","redux/actions/goods.js","redux/actions/catelog.js","page/catelog/index.js"],"names":["ImgLazyLoad","props","_this","Object","E_CodeArea_easyMarket_front_end_easyMarketApp_master_easyMarketApp_master_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","E_CodeArea_easyMarket_front_end_easyMarketApp_master_easyMarketApp_master_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","E_CodeArea_easyMarket_front_end_easyMarketApp_master_easyMarketApp_master_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","state","isLoad","isLoading","handler","bind","E_CodeArea_easyMarket_front_end_easyMarketApp_master_easyMarketApp_master_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__","window","addEventListener","_this2","removeEventListener","_this$props","offSetTop","realUrl","visibleBottom","scrollY","document","documentElement","clientHeight","refs","imgLazyLoad","offsetTop","imgObj","Image","src","setState","Promise","resolve","reject","onload","then","_this$props2","initUrl","imgSrc","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","ref","className","alt","Component","defaultProps","__webpack_require__","r","__webpack_exports__","d","fetchCount","fetchGoodsData","_actionTypes__WEBPACK_IMPORTED_MODULE_0__","parmas","type","ActionsTypes","GOODS_COUNT_GETDATA_REQUSET","GOODS_LIST_GETDATA_REQUSET","fetchInitData","CATALOG_INITDATA_GETDATA_REQUEST","fetchCatelogMsg","CATALOG_CATALOGMSG_GETDATA_REQUEST","changeIdAndTabIndex","objectSpread","CATALOG_CHANGEIDANDTABINDEX","Catelog","saveRef","refDom","actions","actions1","catelogId","index","id","_ref","_this$props$actions","tabIndex","cateLogList","page","tabsHeight","length","Math","floor","history","push","activeCatalogMsg","count","_this$computedTabsPro","computedTabsProperty","react_default","react","onClick","toSearch","concat","style","height","tabs","tabBarUnderlineStyle","left","right","onTabClick","clickTab","tabDirection","tabBarPosition","renderTabBar","DefaultTabBar","assign","renderTab","name","backgroundImage","wap_banner_url","front_name","subCategoryList","map","item","Link","to","key","withRouter","connect","catalog","goods","dispatch","bindActionCreators","catalogAction","goodsAction"],"mappings":"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","file":"static/js/17.2d789e5b.chunk.js","sourcesContent":["import React, {Component} from 'react'\nimport './index.scss'\n//添加事件监听\nclass ImgLazyLoad extends Component{\n  constructor(props) {\n    super(props)\n    this.state = {\n      isLoad: false,\n      isLoading: false,\n    }\n    this.handler = this.handler.bind(this);\n  }\n  componentDidMount () {\n    this.handler()\n    window.addEventListener('scroll', this.handler)\n  }\n  handler () {\n    if(!this.state.isLoading){\n      const {offSetTop, realUrl} = this.props\n      const visibleBottom = window.scrollY + document.documentElement.clientHeight -offSetTop;\n      const imgTop = this.refs.imgLazyLoad.offsetTop\n      if(imgTop < visibleBottom){\n        let imgObj = new Image()\n        imgObj.src = realUrl\n        this.setState({isLoading: true})\n        new Promise((resolve, reject)=>{\n          imgObj.onload = function(){\n            resolve(imgObj)\n          }\n        }).then((imgObj)=>{\n          this.setState({isLoad: true})\n        })\n      }\n    }else{\n      window.removeEventListener('scroll', this.handler)\n    }\n  }\n  componentWillUnmount () {\n    window.removeEventListener('scroll', this.handler)\n  }\n  render () {\n    const { isLoad } = this.state\n    const {realUrl, initUrl} = this.props\n    const imgSrc = isLoad?realUrl: initUrl\n    return (\n      <img ref=\"imgLazyLoad\" className={isLoad?'imgLazyload loadEnd': 'imgLazyload loading'} src={imgSrc} alt=\"imgLazyLoad\"/>\n    )\n  }\n}\nImgLazyLoad.defaultProps = {\n  offSetTop: 40,\n  initUrl: 'https://ss0.bdstatic.com/-0U0bnSm1A5BphGlnYG/tam-ogel/8bc5c8ca3da4043fc6c9dbfb32d5dc89_121_121.jpg'\n}\nexport default ImgLazyLoad\n","import ActionsTypes from './actionTypes';\n\nexport function fetchCount(parmas) {\n  return {\n    type: ActionsTypes.GOODS_COUNT_GETDATA_REQUSET,\n    parmas\n  }\n}\nexport function fetchGoodsData(parmas) {\n  return {\n    type: ActionsTypes.GOODS_LIST_GETDATA_REQUSET,\n    parmas\n  }\n}","import ActionsTypes from './actionTypes';\n\nexport function fetchInitData(parmas) {\n  return {\n    type: ActionsTypes.CATALOG_INITDATA_GETDATA_REQUEST,\n    parmas\n  }\n}\n\nexport function fetchCatelogMsg(parmas) {\n  return {\n    type: ActionsTypes.CATALOG_CATALOGMSG_GETDATA_REQUEST,\n    parmas\n  }\n}\n\nexport function changeIdAndTabIndex(parmas) {\n  return {\n    type: ActionsTypes.CATALOG_CHANGEIDANDTABINDEX,\n    ...parmas\n  }\n}","import React, {Component, Fragment} from 'react'\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport *as catalogAction from '../../redux/actions/catelog'\nimport *as goodsAction from '../../redux/actions/goods'\nimport { Tabs,  } from 'antd-mobile';\nimport {withRouter ,Link} from 'react-router-dom'\nimport './index.css'\nimport ImgLazyLoad from '../../components/imgLazyLoad'\nclass Catelog extends Component{\n  saveRef = ref => {this.refDom = ref}\n  componentWillMount(){\n    const {actions:{fetchInitData},actions1: {fetchCount},catelogId} = this.props\n    fetchInitData({catelogId})\n    fetchCount()\n  }\n  clickTab({id},index){\n    const {actions:{fetchCatelogMsg, changeIdAndTabIndex}} = this.props\n    fetchCatelogMsg({id})\n    changeIdAndTabIndex({catelogId:id,tabIndex:index})\n  }\n  computedTabsProperty () {\n    const {cateLogList} = this.props\n    let page = 0\n    let tabsHeight = 0\n    if(cateLogList.length > 0 && this.refDom){\n      const { clientHeight} = this.refDom;\n      const tabLen =  cateLogList.length * 42\n      tabsHeight = tabLen<clientHeight ? cateLogList.length * 42:clientHeight\n      page = Math.floor(clientHeight / 42)\n    }\n    return {page,tabsHeight}\n  }\n  toSearch () {\n    this.props.history.push('/goodsSearch')\n  }\n  render () {\n    const {cateLogList,activeCatalogMsg,count,tabIndex } = this.props\n    const {page, tabsHeight} = this.computedTabsProperty()\n    return (\n      <Fragment>\n        <div className=\"searchWrap\">\n          <div className=\"searchInput\" onClick={this.toSearch.bind(this)}>\n            <i className=\"fa fa-search\"></i><span>{`搜索商品，共${count}款好物`}</span>\n          </div>\n        </div>\n        <div id=\"tabsWrap\" ref={this.saveRef}>\n          <div style={{height: tabsHeight + 'px'}}>\n            <Tabs tabs={cateLogList}\n                  tabBarUnderlineStyle={{left:\"0\",right:'100%'}}\n                  onTabClick={this.clickTab.bind(this)}\n                  page = {tabIndex}\n                  tabDirection=\"vertical\"  tabBarPosition=\"left\"\n                  renderTabBar={props =>\n                    <Tabs.DefaultTabBar {...props} page={page}\n                                        renderTab={props => <div className=\"tabItem\">{props.name}</div> } />}/>\n          </div>\n        </div>\n        <div className=\"categogContet\">\n          <div className=\"categoryWrap\" style={{backgroundImage:`url(${activeCatalogMsg.wap_banner_url})`}}>\n            {activeCatalogMsg.front_name}\n          </div>\n          <div className=\"categoryTitle\">\n            <div></div>{activeCatalogMsg.name}分类<div></div>\n          </div>\n          <div className=\"subCategory\">\n            {'subCategoryList' in activeCatalogMsg?activeCatalogMsg.subCategoryList.map((item) => (\n              <Link className=\"subCategoryItem\" to={`/categorys/${item.id}`} key={item.id}>\n                <ImgLazyLoad\n                  offSetTop={44}\n                  realUrl = {item.wap_banner_url}>\n                </ImgLazyLoad>\n                <div className=\"subCategoryItemName\">\n                  {item.name}\n                </div>\n              </Link>\n            )):null}\n          </div>\n        </div>\n      </Fragment>\n    )\n  }\n}\nconst mapStateToProps = (state, props) => ({\n    ...state.catalog,\n    count: state.goods.count\n  })\nconst mapDispatchToProps = dispatch => ({\n    actions: bindActionCreators(catalogAction, dispatch),\n    actions1: bindActionCreators(goodsAction,dispatch)\n  })\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Catelog))\n"],"sourceRoot":""}